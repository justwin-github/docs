<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://docs.just.win/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.just.win/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://docs.just.win/main.a559507761b83a1c7fc0d6a763640bcbae9d9e9fa5f501fce1a86662255de96ebb12887a8290f23cc1a87fce0f702fbdafd3a377c53e3974138e6d8cb4e44b93.css integrity="sha512-pVlQd2G4Ohx/wNanY2QLy66dnp+l9QH84ahmYiVd6W67Eoh6gpDyPMGof84PcC+9r9Ojd8U+OXQTjm2MtORLkw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Interacting with contracts - AMMs For Prediction Markets</title><meta name=description content="Description."><link rel=canonical href=https://docs.just.win/docs/tutorial/interacting-with-contracts/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://docs.just.win/doks.png"><meta name=twitter:title content="Interacting with contracts"><meta name=twitter:description content="You should now have deployed three contracts: The LsLMSR, FakeDai, and ConditionalTokens contracts. When we set up the LsLMSR contract, we will need to fund the contract with some initial liquidity. Therefore we will need to get some money before we can proceed with the set up!
Creating tokens to play with If you click on the deployed instance of the FakeDai contract, you should have a number of functions available."><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Interacting with contracts"><meta property="og:description" content="You should now have deployed three contracts: The LsLMSR, FakeDai, and ConditionalTokens contracts. When we set up the LsLMSR contract, we will need to fund the contract with some initial liquidity. Therefore we will need to get some money before we can proceed with the set up!
Creating tokens to play with If you click on the deployed instance of the FakeDai contract, you should have a number of functions available."><meta property="og:type" content="article"><meta property="og:url" content="https://docs.just.win/docs/tutorial/interacting-with-contracts/"><meta property="og:image" content="https://docs.just.win/doks.png"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:site_name" content="AMMs For Prediction Markets"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/docs.just.win\/"},{"@type":"ListItem","position":2,"name":"Docs","item":"https:\/\/docs.just.win\/docs\/"},{"@type":"ListItem","position":3,"name":"Tutorial","item":"https:\/\/docs.just.win\/docs\/tutorial\/"},{"@type":"ListItem","position":4,"name":"Interacting With Contracts","item":"https:\/\/docs.just.win\/docs\/tutorial\/interacting-with-contracts\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://docs.just.win/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://docs.just.win/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.just.win/favicon-16x16.png><link rel=manifest href=https://docs.just.win/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=https://docs.just.win/>AMMs For Prediction Markets</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/justwin-github><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://docs.just.win/docs/>Docs</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Overview</h3><ul class=list-unstyled><li><a class=docs-link href=https://docs.just.win/docs/overview/prediction-markets/>Prediction Markets</a></li><li><a class=docs-link href=https://docs.just.win/docs/overview/automated_market_makers/>Automated Market Makers</a></li><li><a class=docs-link href=https://docs.just.win/docs/overview/conditional_token/>Conditional Token Framework</a></li><li><a class=docs-link href=https://docs.just.win/docs/overview/oracles/>Oracles</a></li><li><a class=docs-link href=https://docs.just.win/docs/overview/lsmr/>LSMR & LS-LSMR</a></li></ul><h3>Tutorial</h3><ul class=list-unstyled><li><a class=docs-link href=https://docs.just.win/docs/tutorial/getting-started/>Getting Started</a></li><li><a class=docs-link href=https://docs.just.win/docs/tutorial/import-into-remix/>Import into Remix</a></li><li><a class=docs-link href=https://docs.just.win/docs/tutorial/deploying-contracts/>Deploying Contracts</a></li><li><a class="docs-link active" href=https://docs.just.win/docs/tutorial/interacting-with-contracts/>Interacting with contracts</a></li><li><a class=docs-link href=https://docs.just.win/docs/tutorial/deploying-to-testnet/>Deploying to Testnet</a></li></ul><h3>Developer Guide</h3><ul class=list-unstyled><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/introduction/>Introduction</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/lslmsr/>LsLMSR</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/constructor/>Constructor</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/buy/>Setup</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/withdraw/>Withdraw</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/price/>Price</a></li><li><a class=docs-link href=https://docs.just.win/docs/developer-guide/cost/>Cost</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#creating-tokens-to-play-with>Creating tokens to play with</a></li><li><a href=#setting-up-the-lslmsr>Setting up the LsLMSR</a></li><li><a href=#buying-outcome-tokens>Buying outcome tokens</a></li><li><a href=#reporting-payout-and-claiming-rewards>Reporting payout and claiming rewards</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Interacting with contracts</h1><p class=lead></p><p>You should now have deployed three contracts: The LsLMSR, FakeDai, and ConditionalTokens contracts. When we set up the LsLMSR contract, we will need to fund the contract with some initial liquidity. Therefore we will need to get some money before we can proceed with the set up!</p><h3 id=creating-tokens-to-play-with>Creating tokens to play with<a href=#creating-tokens-to-play-with class=anchor aria-hidden=true>#</a></h3><p>If you click on the deployed instance of the FakeDai contract, you should have a number of functions available. The orange functions are transactions that you can send, whilst the blue functions are view functions. </p><img src=https://lh3.googleusercontent.com/o1a_A8BGcumEd6-MIYGyZcHO28DRCn37lR2WTkrw80cR0vcbfCUgQ-FN_LINXLlIlNOvEwQW-0IWgtDFofyW7NiFdoDvnoQ81g6feTFhFNuVxxCIAH9heF812758c13xli66lUii alt=compile width=100%><p>These functions are found on all ERC20 token contracts with the exception of the mint function. This mint function is a debugging function and takes two parameters, the &lsquo;account&rsquo; and the &lsquo;amount&rsquo;. You will need to enter your address in order to receive the tokens, this address can be found near the top of the remix interface. The &lsquo;amount&rsquo; that you enter will need to include the appropriate number of decimals for the token you are using. If we want to create 1000 Dai (which has 18 decimals), we will therefore need to put the amount as 100000000000000000000. </p><p>You can confirm that this worked by calling the balanceOf function and inputting the same address. This should output the same number.</p><p>Now that you have minted 1000 Dai, you need to allow the LsLMSR contract to spend this money. You will need to call the approve() function and input the address of the LsLMSR contract as the spender and the amount as the total amount that you will want to spend. Let us approve 1000 Dai. For me this looks like:</p><p><img src=https://lh6.googleusercontent.com/AiSB8MrkMiYJ51SSUAS0kQNP_Xm5qoMphZ1P0ui6quTNC5XwkMD6qcv22ZMT65YaGiOLk2AL6S_vGkpAW58jzOwocaAiDv44Nn5V40vuUZ2ZfDQpAFXkDl9UDdBB8vlZqjhsTB7P alt></p><h3 id=setting-up-the-lslmsr>Setting up the LsLMSR<a href=#setting-up-the-lslmsr class=anchor aria-hidden=true>#</a></h3><p>Now you will need to select the LsLMSR and run the setup() function. This has a number of parameters which we will discuss:</p><p><img src=https://lh4.googleusercontent.com/uPamXuVj6xYZVsv242pvZTejn92v5T8IFlgh3cTLdtCq2F6HfP9NCF5dX1h2Z_AlrE296v3LWFBdtGLulYKcf6-uaPoAXo4PDpniYSXDb0Am3BJXTuPetEjLLxBY_iSCOlKKBGWb alt></p><ul><li><p>_oracle will be an address that refers to either an externally owned address, or a smart contract. The prediction market will remain open until this oracle address tells the prediction market what the outcome of the event was. We invite you to read the oracle page for different ideas of what to put here. For our testing purposes, we can use the address for our account. This will be easy for us to report the outcome at the end of our tutorial</p></li><li><p>_numOutcomes is an integer which represents the number of different outcomes that are available. For example, the number of outcomes for a football match would be 3: home team win, away team win, draw. It is worth mentioning at this point, that the conditional tokens allow users to bet on combinations such as either home team winning or draw occurring however the number of discrete outcomes remains 3.</p></li><li><p>_subsidy is an integer which represents how much initial funding is available for the prediction market in order to create the prices. There is a trade-off to be made within the LsLMSR algorithm. More initial funding results in a more liquid market, however it increases the potential losses as the bounded loss is proportional to the initial liquidity.</p></li><li><p>_overround is an integer which represents how much &lsquo;profit&rsquo; will be taken by the market maker. This number is represented in &lsquo;bips&rsquo; where 100 is equal to 1% profit. If you wish to add 4.5% overround, you would therefore need to enter 450. Traditional book makers would tend to use values between 5 and 10% depending on the nature of the market.</p></li></ul><p>Let us make a prediction market for the Superbowl.</p><p>_oracle will be our address. This means that we will be responsible for correctly reporting on the outcome after the superbowl.</p><p>_numOutcomes will be 3: For Buccaneers win, Chiefs win, draw. </p><p>_subsidy will be 1000000000000000000000 - this represents 1000 Dai in initial funding</p><p>_overround will be 450. This books us 4.5% profit</p><p>Your setup will look like this:</p><p><img src=https://lh5.googleusercontent.com/_BVFTPIiCAhmuoQ6kKIB8_MyHnYzemQubty6cAN7utmf7V928qORIzKSdYLGaeYu6hzGyLWnymdylxJfNQAeocZYFU9UlQPaEsYPAXOpgmjoWFHglX6zfRe_PV_34nf5G1KeDk-0 alt></p><p>Once you submit this transaction, the prediction market will be ready for users to interact with!</p><h3 id=buying-outcome-tokens>Buying outcome tokens<a href=#buying-outcome-tokens class=anchor aria-hidden=true>#</a></h3><p>The buy() function is used to purchase outcome tokens. This function has two parameters which require some additional steps to calculate: the outcome, and the amount.</p><p>In order to know what to put for _outcome, we need to briefly discuss how the conditional tokens contract represents each outcome. We have established that we have chosen three discrete outcomes for our event. If we assume the following outcomes:</p><p>Outcome 1: Buccaneers win</p><p>Outcome 2: Chiefs win</p><p>Outcome 3: Draw</p><p>We can therefore construct a position based on any combination of these outcomes. If we think that the chiefs will win but also that there may be a draw, then we will purchase tokens for outcomes 2 and 3. Conditional tokens allow us to have a position in both these outcomes by combining the outcomes into a collection. Outcomes that will be included within the collection will be represented in binary with a 1. We can therefore construct:</p><p>Outcome 1: 0</p><p>Outcome 2: 1</p><p>Outcome 3: 1</p><p>This can be expressed in binary as 0b110. Note that this is backwards where the first 1 represents outcome 3. 0b110 as an integer is 6.Therefore, if we wish to purchase tokens for Chiefs winning or there being a draw, we will need to put _outcome as 6.</p><p>The _amount represents the amount of tokens that we wish to purchase. It is worth mentioning at this point that 1 outcome token pays out 1 of the base currency. Although the price of underlying base currency can fluctuate, the outcome tokens will always be proportional to the price of the underlying. The _amount is submitted as a fixed point integer. This is the desired number multiplied by 2^64. If you wish to purchase one outcome token, you will therefore need to enter 18446744073709551616.</p><p>Let us purchase outcome tokens that will pay out 10 Dai if the Chiefs win or draw. We will therefore need to enter:</p><p><img src=https://lh4.googleusercontent.com/8vIHGuNt9scsc71rT-ERen_IrgOAvYAxvnf9DwMtdOe3cDSCuC0GQyriaLsP_0SQA5NjMdoZQjx7bAhb768McoauIRZK1JQbXlJmBNidH50NGG9cDP8bpWz_CgWZMvGch0DuNvOV alt></p><p>Note the 0 at the end of _amount to signify ten outcome tokens.</p><p>If you followed the tutorial, you should have received an error message telling you &ldquo;ERC20: transfer amount exceeds balance&rdquo;. See if you can mint some more dai, and then approve this to be spent again and re-try!</p><p>Congratulations, you&rsquo;ve just bought your tokens from the market maker.</p><h3 id=reporting-payout-and-claiming-rewards>Reporting payout and claiming rewards<a href=#reporting-payout-and-claiming-rewards class=anchor aria-hidden=true>#</a></h3><p>As we set the oracle for the contract to be our address, we are able to set the outcome of the market. We do this by calling the reportPayouts() function found within the conditional tokens contract. We must input the questionId and the outcome.</p><p>The questionId will be the address of the LsLMSR contract. You need to convert this into bytes32 notation and can do this with the AddToBytes() function found within the LsLMSR. For me, this looks like 0x000000000000000000000000d7acd2a9fd159e69bb102a1ca21c9a3e3a5f771b and is simply the address padded with an appropriate number of zeros.</p><p>The payout variable takes an array of the relative payout for each outcome. As we chose three outcomes, we will need to enter an array with three variables here. If you wanted to report that the Chiefs won, you will enter this outcome as a 1 (which means each outcome token can be redeemed for 1 base currency) and the rest as zero. </p><p><img src=https://lh4.googleusercontent.com/oaoc1rOrI99WmV97cEG2gpDtik1cgjOmRux5Pu7eXEcK-Oj43159ec6S53PxL9wYphZgJy1MV65t5Pun2jnTK0c0dNsmWjsvfwl3ha0RPQcDmX89cwhnNqHqFLE3G7tr8lpeCLGu alt></p><p>Now that you have done this, you can claim your reward for the successful portion of your position. You do this with the redeemPositions() function. This function takes your outcome tokens and then converts them back into the base currency token. The redeemPositions() function takes the following parameters:</p><ul><li><p>collateralToken: the address for the ERC-20 token used</p></li><li><p>parentCollectionId: this will be 0x0000000000000000000000000000000000000000000000000000000000000000</p></li><li><p>conditionId: this can be found by clicking on the &lsquo;condition&rsquo; button within the LsLMSR contract or calculated by the getConditionId() function on conditional tokens</p></li><li><p>indexSets: this will be the same number as the integer representation of your positions, displayed as an array. For us this will be [6]</p></li></ul><p>If you check your balance of collateral token, you should notice that you have more dai than when you started!</p><div class="docs-navigation d-flex justify-content-between"><a href=https://docs.just.win/docs/tutorial/deploying-contracts/><div class="card my-1"><div class="card-body py-2">&larr; Deploying Contracts</div></div></a><a class=ml-auto href=https://docs.just.win/docs/tutorial/deploying-to-testnet/><div class="card my-1"><div class="card-body py-2">Deploying to Testnet &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by the Just Win team. Funded by Gnosis.</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline></ul></div></div></div></footer><script src=https://docs.just.win/main.f6b484f556ad1f3bcf6061082139a2f21fa759f13930c39a25fe4a9f78f35e64122c2d86dffd56e67b292dabbda4095d8077194f196e0e348441c106a9f3d40e.js integrity="sha512-9rSE9VatHzvPYGEIITmi8h+nWfE5MMOaJf5Kn3jzXmQSLC2G3/1W5nspLau9pAldgHcZTxluDjSEQcEGqfPUDg==" crossorigin=anonymous defer></script><script src=https://docs.just.win/index.min.cbdbf55b8577f0f18eade8f5c8808784909b52394fa7d416bab806f607ac4a375e7d3d80a6040a1a3960894996aa67273f5f3df089ec8e84412f87f72d1a11f9.js integrity="sha512-y9v1W4V38PGOrej1yICHhJCbUjlPp9QWurgG9gesSjdefT2ApgQKGjlgiUmWqmcnP1898InsjoRBL4f3LRoR+Q==" crossorigin=anonymous defer></script></body></html>